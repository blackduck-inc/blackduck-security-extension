{
  "$schema": "https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json",
  "id": "ba467646-b723-4aba-a14d-bdbe8d6d5329",
  "name": "BlackDuckSecurityScan",
  "friendlyName": "Black Duck Security Scan",
  "description": "Run security scans on Polaris, Black Duck SCA, Coverity or Software Risk Manager (SRM) platforms",
  "helpMarkDown": "",
  "category": "Utility",
  "author": "Black Duck Software Inc.",
  "version": {
    "Major": 2,
    "Minor": 5,
    "Patch": 0
  },
  "instanceNameFormat": "Black Duck Security Scan",
  "groups": [
    {
      "name": "scanConfiguration",
      "displayName": "Scan Configuration",
      "isExpanded": true
    },
    {
      "name": "polarisScanOptions",
      "displayName": "Scan Options",
      "isExpanded": false,
      "visibleRule": "scanType = polaris"
    },
    {
      "name": "polarisPREnable",
      "displayName": "Pull Request Comment Options",
      "isExpanded": false,
      "visibleRule": "polarisWaitForScan = true"
    },
    {
      "name": "polarisSarifReport",
      "displayName": "SARIF Report Options",
      "isExpanded": false,
      "visibleRule": "polarisWaitForScan = true"
    },
    {
      "name": "blackduckScaScanOptions",
      "displayName": "Scan Options",
      "isExpanded": false,
      "visibleRule": "scanType = blackducksca"
    },
    {
      "name": "blackduckScaPREnable",
      "displayName": "Pull Request Comment Options",
      "isExpanded": false,
      "visibleRule": "scanType = blackducksca && blackduckScaWaitForScan = true"
    },
    {
      "name": "blackduckScaFixPR",
      "displayName": "Fix Pull Request Options",
      "isExpanded": false,
      "visibleRule": "scanType = blackducksca && blackduckScaWaitForScan = true"
    },
    {
      "name": "blackduckScaSarifReport",
      "displayName": "SARIF Report Options",
      "isExpanded": false,
      "visibleRule": "scanType = blackducksca && blackduckScaWaitForScan = true"
    },
    {
      "name": "blackduckScaToolOptions",
      "displayName": "Detect (SCA) Tool Options",
      "isExpanded": false,
      "visibleRule": "scanType = blackducksca"
    },
    {
      "name": "coverityScanOptions",
      "displayName": "Scan Options",
      "isExpanded": false,
      "visibleRule": "scanType = coverity"
    },
    {
      "name": "coverityPREnable",
      "displayName": "Pull Request Comment Options",
      "isExpanded": false,
      "visibleRule": "coverityWaitForScan = true"
    },
    {
      "name": "coverityToolOptions",
      "displayName": "Coverity (SAST) Tool Options",
      "isExpanded": false,
      "visibleRule": "scanType = coverity"
    },
    {
      "name": "coverityToolOptionsForPolaris",
      "displayName": "Coverity (SAST) Tool Options",
      "isExpanded": false,
      "visibleRule": "scanType = polaris"
    },
    {
      "name": "blackduckScaToolOptionsForPolaris",
      "displayName": "Detect (SCA) Tool Options",
      "isExpanded": false,
      "visibleRule": "scanType = polaris"
    },
    {
      "name": "srmScanOptions",
      "displayName": "Scan Options",
      "isExpanded": false,
      "visibleRule": "scanType = srm"
    },
    {
      "name": "coverityToolOptionsForSrm",
      "displayName": "Coverity (SAST) Tool Options",
      "isExpanded": false,
      "visibleRule": "scanType = srm"
    },
    {
      "name": "blackduckScaToolOptionsForSrm",
      "displayName": "Detect (SCA) Tool Options",
      "isExpanded": false,
      "visibleRule": "scanType = srm"
    },
    {
      "name": "bridgecliOptions",
      "displayName": "Bridge CLI Options",
      "isExpanded": false
    },
    {
      "name": "networkOptions",
      "displayName": "Network Options",
      "isExpanded": false
    }
  ],
  "inputs": [
    {
      "name": "bridgeCliDownloadUrl",
      "type": "string",
      "label": "Bridge CLI Download URL",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Provide the URL from where bridge-cli-bundle zip file can be downloaded. Note: You must provide the full download url which includes the zip file path.",
      "groupName": "bridgecliOptions"
    },
    {
      "name": "bridgeCliDownloadVersion",
      "type": "string",
      "label": "Bridge CLI Download Version",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Provide the specific Bridge CLI version you want to download from Black Duck artifactory.",
      "groupName": "bridgecliOptions"
    },
    {
      "name": "bridgeCliInstallDirectory",
      "type": "string",
      "label": "Bridge CLI Installation Directory",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Provide the Bridge CLI installation directory on the agent where it will be installed during the build.",
      "groupName": "bridgecliOptions"
    },
    {
      "name": "networkAirgap",
      "type": "boolean",
      "label": "Network Airgap",
      "defaultValue": false,
      "required": false,
      "helpMarkDown": "If provided, Black Duck Task will be using local network to download and execute bridge-CLI.",
      "groupName": "networkOptions"
    },
    {
      "name": "networkSslTrustAll",
      "type": "boolean",
      "label": "Trust All SSL Certificates",
      "defaultValue": false,
      "required": false,
      "helpMarkDown": "TrustALL -> Disables SSL certificate verification. Use with caution.",
      "groupName": "networkOptions"
    },
    {
      "name": "networkSslCertFile",
      "type": "string",
      "label": "SSL Certificate File",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Cert file path -> Path to a file that includes one or more trusted CA certificates. Supported formats: PEM, CRT.",
      "groupName": "networkOptions"
    },
    {
      "name": "scanType",
      "type": "pickList",
      "label": "Product",
      "required": true,
      "helpMarkDown": "Select Required Product",
      "defaultValue": "",
      "options": {
        "": "Select",
        "polaris": "Polaris",
        "blackducksca": "Black Duck SCA",
        "coverity": "Coverity Platform",
        "srm": "Software Risk Manager (SRM)"
      },
      "groupName": "scanConfiguration"
    },
    {
      "name": "polarisServerUrl",
      "type": "string",
      "label": "URL",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "URL for Polaris Server.",
      "visibleRule": "scanType = polaris",
      "groupName": "scanConfiguration"
    },
    {
      "name": "polarisAccessToken",
      "type": "string",
      "label": "Access Token",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Access token for Polaris Server with proper authorization.",
      "visibleRule": "scanType = polaris",
      "groupName": "scanConfiguration"
    },
    {
      "name": "polarisAssessmentTypes",
      "type": "string",
      "label": "Assessment Types",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Polaris assessment types. Supported values: SCA or SAST or both SCA, SAST",
      "visibleRule": "scanType = polaris",
      "groupName": "scanConfiguration"
    },
    {
      "name": "polarisTestScaType",
      "type": "string",
      "label": "SCA Test Type",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Polaris test type to trigger signature scan or package manager scan. Default value: SCA-PACKAGE. Supported values: SCA-PACKAGE or SCA-SIGNATURE",
      "visibleRule": "scanType = polaris",
      "groupName": "scanConfiguration"
    },
    {
      "name": "polarisTestSastType",
      "type": "string",
      "label": "SAST Test Type",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Polaris test type to trigger sigma rapid scan or full scan. Supported values: SAST_RAPID or SAST_FULL",
      "visibleRule": "scanType = polaris",
      "groupName": "scanConfiguration"
    },
    {
      "name": "polarisProjectDirectory",
      "type": "string",
      "label": "Project Directory",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "The project source directory. Defaults to repository root directory. Set this to specify a custom folder that is other than repository root",
      "visibleRule": "scanType = polaris",
      "groupName": "scanConfiguration"
    },
    {
      "name": "polarisMarkBuildStatus",
      "type": "pickList",
      "label": "Mark Build Status",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Specify the build status to use if policy violating issues are found. Default value: Failed. Supported values are: Failed, SucceededWithIssues and Succeeded.",
      "options": {
        "": "Select",
        "Failed": "Failed",
        "SucceededWithIssues": "SucceededWithIssues",
        "Succeeded": "Succeeded"
      },
      "visibleRule": "scanType = polaris",
      "groupName": "scanConfiguration"
    },
    {
      "name": "polarisAzureToken",
      "type": "string",
      "label": "Azure Token",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "PAT or System.AccessToken has to be passed with legitimate access when Polaris PR comment and Polaris Create SARIF is enabled.",
      "visibleRule": "scanType = polaris",
      "groupName": "scanConfiguration"
    },
    {
      "name": "polarisIncludeDiagnostics",
      "type": "boolean",
      "label": "Include Diagnostics",
      "defaultValue": false,
      "required": false,
      "helpMarkDown": "Bridge CLI diagnostics will be uploaded in Artifact. Supported values: true or false",
      "visibleRule": "scanType = polaris",
      "groupName": "scanConfiguration"
    },
    {
      "name": "polarisWaitForScan",
      "type": "boolean",
      "label": "Wait For Scan Completion",
      "defaultValue": true,
      "required": false,
      "helpMarkDown": "Specifies if the workflow should wait for the analysis to complete. Default value: true. If set to false, post merge workflows like PR comment, SARIF etc will not be applicable.",
      "visibleRule": "scanType = polaris",
      "groupName": "scanConfiguration"
    },
    {
      "name": "polarisApplicationName",
      "type": "string",
      "label": "Polaris Application",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Application name in Polaris Server. If not provided, Azure repository name will be set as default value.",
      "groupName": "polarisScanOptions"
    },
    {
      "name": "polarisProjectName",
      "type": "string",
      "label": "Polaris Project",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Project name in Polaris Server. If not provided, Azure repository name will be set as default value.",
      "groupName": "polarisScanOptions"
    },
    {
      "name": "polarisBranchName",
      "type": "string",
      "label": "Polaris Branch",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Branch name in Polaris Server.",
      "groupName": "polarisScanOptions"
    },
    {
      "name": "polarisTestScaLocation",
      "type": "pickList",
      "label": "SCA Test Location",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Polaris SCA test location. Default value: HYBRID. Supported values: HYBRID or REMOTE.\nNOTE: Polaris Assessment Mode is deprecated. Use Polaris SCA Test Location as REMOTE for source upload scans instead",
      "options": {
        "": "Select",
        "hybrid": "HYBRID",
        "remote": "REMOTE"
      },
      "groupName": "polarisScanOptions"
    },
    {
      "name": "polarisTestSastLocation",
      "type": "pickList",
      "label": "SAST Test Location",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Polaris SAST test location. Default value: HYBRID. Supported values: LOCAL or HYBRID or REMOTE.\nNOTE: Polaris Assessment Mode is deprecated. Use Polaris SAST Test Location as REMOTE for source upload scans instead",
      "options": {
        "": "Select",
        "local": "LOCAL",
        "hybrid": "HYBRID",
        "remote": "REMOTE"
      },
      "groupName": "polarisScanOptions"
    },
    {
      "name": "projectSourceArchive",
      "type": "string",
      "label": "Upload Archive Instead Of Directory",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "The zipped source file path. It overrides the project directory setting above",
      "visibleRule": "polarisTestSastLocation = remote || polarisTestScaLocation = remote ",
      "groupName": "polarisScanOptions"
    },
    {
      "name": "projectSourceExcludes",
      "type": "string",
      "label": "Project Source Excludes",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "A list of git ignore pattern strings that indicate the files need to be excluded from the zip file.",
      "visibleRule": "polarisTestSastLocation = remote || polarisTestScaLocation = remote ",
      "groupName": "polarisScanOptions"
    },
    {
      "name": "projectSourcePreserveSymLinks",
      "type": "boolean",
      "label": "Project Source Preserve SymLinks",
      "defaultValue": false,
      "required": false,
      "helpMarkDown": "Flag indicating whether to preserve symlinks in the source zip",
      "visibleRule": "polarisTestSastLocation = remote || polarisTestScaLocation = remote ",
      "groupName": "polarisScanOptions"
    },
    {
      "name": "polarisPrCommentEnabled",
      "type": "boolean",
      "label": "Add Comments to Pull Requests",
      "defaultValue": false,
      "required": false,
      "helpMarkDown": "Add automatic pull request comment based on Polaris scan result. Supported values: true or false. Requires Azure Token.",
      "groupName": "polarisPREnable"
    },
    {
      "name": "polarisPrCommentSeverities",
      "type": "string",
      "label": "PR Comment Severities",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Comma separated list of severities. Comments are created for issues where the issue severity matches one of the values specified using this option. Supported values: CRITICAL,HIGH,MEDIUM,LOW,INFORMATIONAL",
      "visibleRule": "polarisPrCommentEnabled = true",
      "groupName": "polarisPREnable"
    },
    {
      "name": "polarisBranchParentName",
      "type": "string",
      "label": "Parent Branch Name",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Parent Branch name in Polaris.",
      "visibleRule": "polarisPrCommentEnabled = true",
      "groupName": "polarisPREnable"
    },
    {
      "name": "polarisReportsSarifCreate",
      "type": "boolean",
      "label": "Generate SARIF Report",
      "defaultValue": false,
      "required": false,
      "helpMarkDown": "SARIF report will be uploaded as a Artifact.",
      "groupName": "polarisSarifReport"
    },
    {
      "name": "polarisReportsSarifGroupSCAIssues",
      "type": "boolean",
      "label": "Group SCA Issues by Component",
      "defaultValue": true,
      "required": false,
      "helpMarkDown": "Uncheck this to disable grouping by component and list SCA issues by vulnerability.",
      "visibleRule": "polarisReportsSarifCreate = true",
      "groupName": "polarisSarifReport"
    },
    {
      "name": "polarisReportsSarifFilePath",
      "type": "string",
      "label": "SARIF Report File Path",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "File path (including file name) where SARIF report is created.",
      "visibleRule": "polarisReportsSarifCreate = true",
      "groupName": "polarisSarifReport"
    },
    {
      "name": "polarisReportsSarifSeverities",
      "type": "string",
      "label": "SARIF Report Severities",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Comma separated list of issue severities to include in SARIF report. Supported values: CRITICAL,HIGH,MEDIUM,LOW.",
      "visibleRule": "polarisReportsSarifCreate = true",
      "groupName": "polarisSarifReport"
    },
    {
      "name": "polarisReportsSarifIssueTypes",
      "type": "string",
      "label": "SARIF Report Issue Types",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Comma separated list of issues types to include in SARIF report. Supported values: SAST,SCA.",
      "visibleRule": "polarisReportsSarifCreate = true",
      "groupName": "polarisSarifReport"
    },
    {
      "name": "coverityUrl",
      "type": "string",
      "label": "URL",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "URL for Coverity platform.",
      "visibleRule": "scanType = coverity",
      "groupName": "scanConfiguration"
    },
    {
      "name": "coverityUser",
      "type": "string",
      "label": "Username",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Username for Coverity.",
      "visibleRule": "scanType = coverity",
      "groupName": "scanConfiguration"
    },
    {
      "name": "coverityUserPassword",
      "type": "string",
      "label": "Password",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Password for Coverity.",
      "visibleRule": "scanType = coverity",
      "groupName": "scanConfiguration"
    },
    {
      "name": "coverityProjectDirectory",
      "type": "string",
      "label": "Project Directory",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "The project source directory. Defaults to repository root directory. Set this to specify a custom folder that is other than repository root",
      "visibleRule": "scanType = coverity",
      "groupName": "scanConfiguration"
    },
    {
      "name": "coverityMarkBuildStatus",
      "type": "pickList",
      "label": "Mark Build Status",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Specify the build status to use if policy violating issues are found. Default value: Failed. Supported values are: Failed, SucceededWithIssues and Succeeded.",
      "options": {
        "": "Select",
        "Failed": "Failed",
        "SucceededWithIssues": "SucceededWithIssues",
        "Succeeded": "Succeeded"
      },
      "visibleRule": "scanType = coverity",
      "groupName": "scanConfiguration"
    },
    {
      "name": "coverityAzureToken",
      "type": "string",
      "label": "Azure Token",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "PAT or System.AccessToken has to be passed with legitimate access when Coverity PR comment is enabled.",
      "visibleRule": "scanType = coverity",
      "groupName": "scanConfiguration"
    },
    {
      "name": "coverityLocal",
      "type": "boolean",
      "label": "Run Coverity Analysis Locally",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Check to run analysis locally. If unchecked, scan will be performed on scan farm.",
      "visibleRule": "scanType = coverity",
      "groupName": "scanConfiguration"
    },
    {
      "name": "CoverityIncludeDiagnostics",
      "type": "boolean",
      "label": "Include Diagnostics",
      "defaultValue": false,
      "required": false,
      "helpMarkDown": "Bridge CLI diagnostics will be uploaded in Artifact. Supported values: true or false",
      "visibleRule": "scanType = coverity",
      "groupName": "scanConfiguration"
    },
    {
      "name": "coverityWaitForScan",
      "type": "boolean",
      "label": "Wait For Scan Completion",
      "defaultValue": true,
      "required": false,
      "helpMarkDown": "Specifies if the workflow should wait for the analysis to complete. Default value: true. If set to false, post merge workflows like PR comment etc will not be applicable.",
      "visibleRule": "scanType = coverity",
      "groupName": "scanConfiguration"
    },
    {
      "name": "coverityProjectName",
      "type": "string",
      "label": "Coverity Project",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Project name in Coverity. If not provided, Azure repository name will be set as default value.",
      "groupName": "coverityScanOptions"
    },
    {
      "name": "coverityStreamName",
      "type": "string",
      "label": "Coverity Stream",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Stream name in Coverity. If not provided, for non-PR context Azure repository name concatenated with source branch name (i.e. testRepo-feature1) and for PR context Azure repository name concatenated with target branch name (i.e. testRepo-main) will be set as default value.",
      "groupName": "coverityScanOptions"
    },
    {
      "name": "coverityPolicyView",
      "type": "string",
      "label": "Coverity Policy View",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Name/ID number of a saved view to apply as a 'break the build' policy.",
      "groupName": "coverityScanOptions"
    },
    {
      "name": "coverityVersion",
      "type": "string",
      "label": "Coverity Version",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Version of Coverity Thin Client to use.",
      "groupName": "coverityScanOptions"
    },
    {
      "name": "coverityPrCommentEnabled",
      "type": "boolean",
      "label": "Add Comments to Pull Requests",
      "defaultValue": false,
      "required": false,
      "helpMarkDown": "Add automatic pull request comment based on Coverity scan result. Supported values: true or false. Requires Azure Token.",
      "groupName": "coverityPREnable"
    },
    {
      "name": "coverityPrCommentImpacts",
      "type": "string",
      "label": "Filter PR comments by Coverity Impact",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Comments are created for issues whose impact matches one of the values specified in the Filter PR comments by Coverity Impact. The default value is HIGH. Supported values are HIGH, MEDIUM, LOW, and AUDIT.",
      "visibleRule": "coverityPrCommentEnabled = true",
      "groupName": "coverityPREnable"
    },
    {
      "name": "coverityBuildCommand",
      "type": "string",
      "label": "Build Command",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Build command for Coverity",
      "groupName": "coverityToolOptions"
    },
    {
      "name": "coverityCleanCommand",
      "type": "string",
      "label": "Clean Command",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Clean command for Coverity",
      "groupName": "coverityToolOptions"
    },
    {
      "name": "coverityConfigPath",
      "type": "string",
      "label": "Config File Path",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Coverity config file path (.yaml/.yml/.json).",
      "groupName": "coverityToolOptions"
    },
    {
      "name": "coverityArgs",
      "type": "string",
      "label": "Additional Arguments",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Additional Coverity Arguments separated by space.",
      "groupName": "coverityToolOptions"
    },
    {
      "name": "coverityInstallDirectory",
      "type": "string",
      "label": "Installation Directory",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Provide the Coverity installation directory on the agent where it will be installed during the build.",
      "groupName": "coverityToolOptions"
    },
    {
      "name": "coverityBuildCommandForPolaris",
      "type": "string",
      "label": "Build Command",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Build command for Coverity.",
      "groupName": "coverityToolOptionsForPolaris"
    },
    {
      "name": "coverityCleanCommandForPolaris",
      "type": "string",
      "label": "Clean Command",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Clean command for Coverity.",
      "groupName": "coverityToolOptionsForPolaris"
    },
    {
      "name": "coverityConfigPathForPolaris",
      "type": "string",
      "label": "Config File Path",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Coverity config file path (.yaml/.yml/.json).",
      "groupName": "coverityToolOptionsForPolaris"
    },
    {
      "name": "coverityArgsForPolaris",
      "type": "string",
      "label": "Additional Arguments",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Additional Coverity Arguments separated by space.",
      "groupName": "coverityToolOptionsForPolaris"
    },
    {
      "name": "coverityBuildCommandForSrm",
      "type": "string",
      "label": "Build Command",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Build command for Coverity.",
      "groupName": "coverityToolOptionsForSrm"
    },
    {
      "name": "coverityCleanCommandForSrm",
      "type": "string",
      "label": "Clean Command",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Clean command for Coverity.",
      "groupName": "coverityToolOptionsForSrm"
    },
    {
      "name": "coverityConfigPathForSrm",
      "type": "string",
      "label": "Config File Path",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Coverity config file path (.yaml/.yml/.json).",
      "groupName": "coverityToolOptionsForSrm"
    },
    {
      "name": "coverityArgsForSrm",
      "type": "string",
      "label": "Additional Arguments",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Additional Coverity Arguments separated by space.",
      "groupName": "coverityToolOptionsForSrm"
    },
    {
      "name": "coverityExecutionPath",
      "type": "string",
      "label": "Coverity Execution Path",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Provide the Coverity execution path on the agent where it will be installed during the build.",
      "groupName": "coverityToolOptionsForSrm"
    },
    {
      "name": "blackduckScaUrl",
      "type": "string",
      "label": "URL",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "URL for Black Duck SCA server.",
      "visibleRule": "scanType = blackducksca",
      "groupName": "scanConfiguration"
    },
    {
      "name": "blackduckScaToken",
      "type": "string",
      "label": "Access Token",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "API token for Black Duck SCA Server with proper authorization.",
      "visibleRule": "scanType = blackducksca",
      "groupName": "scanConfiguration"
    },
    {
      "name": "blackduckScaProjectDirectory",
      "type": "string",
      "label": "Project Directory",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "The project source directory. Defaults to repository root directory. Set this to specify a custom folder that is other than repository root",
      "visibleRule": "scanType = blackducksca",
      "groupName": "scanConfiguration"
    },
    {
      "name": "blackduckScaMarkBuildStatus",
      "type": "pickList",
      "label": "Mark Build Status",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Specify the build status to use if policy violating issues are found. Default value: Failed. Supported values are: Failed, SucceededWithIssues and Succeeded.",
      "options": {
        "": "Select",
        "Failed": "Failed",
        "SucceededWithIssues": "SucceededWithIssues",
        "Succeeded": "Succeeded"
      },
      "visibleRule": "scanType = blackducksca",
      "groupName": "scanConfiguration"
    },
    {
      "name": "blackduckScaAzureToken",
      "type": "string",
      "label": "Azure Token",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "PAT or System.AccessToken has to be passed with legitimate access when BlackduckSCA PR comment, BlackduckSCA FIX PR and BlackduckSCA Create SARIF is enabled.",
      "visibleRule": "scanType = blackducksca",
      "groupName": "scanConfiguration"
    },
    {
      "name": "blackduckScaIncludeDiagnostics",
      "type": "boolean",
      "label": "Include Diagnostics",
      "defaultValue": false,
      "required": false,
      "helpMarkDown": "Bridge CLI diagnostics will be uploaded in Artifact. Supported values: true or false",
      "visibleRule": "scanType = blackducksca",
      "groupName": "scanConfiguration"
    },
    {
      "name": "blackduckScaWaitForScan",
      "type": "boolean",
      "label": "Wait For Scan Completion",
      "defaultValue": true,
      "required": false,
      "helpMarkDown": "Specifies if the workflow should wait for the analysis to complete. Default value: true. If set to false, post merge workflows like PR comment, Fix PR, SARIF etc will not be applicable.",
      "visibleRule": "scanType = blackducksca",
      "groupName": "scanConfiguration"
    },
    {
      "name": "blackduckScaPrCommentEnabled",
      "type": "boolean",
      "label": "Add Comments to Pull Requests",
      "defaultValue": false,
      "required": false,
      "helpMarkDown": "Add automatic pull request comment based on Black Duck SCA scan result. Supported values: true or false. Requires Azure Token.",
      "groupName": "blackduckScaPREnable"
    },
    {
      "name": "blackduckScaFixPrEnabled",
      "type": "boolean",
      "label": "Create Fix Pull Requests",
      "defaultValue": false,
      "required": false,
      "helpMarkDown": "Flag to enable/disable the automatic fix pull request creations for Black Duck SCA.\nDefault value is false",
      "groupName": "blackduckScaFixPR"
    },
    {
      "name": "blackduckScaFixPrMaxCount",
      "type": "string",
      "label": "Maximum number of Pull Requests to be created",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Maximum number of pull requests to be created that violate policies. PR is created for each vulnerable component",
      "visibleRule": "blackduckScaFixPrEnabled = true",
      "groupName": "blackduckScaFixPR"
    },
    {
      "name": "blackduckScaFixPrUseUpgradeGuidance",
      "type": "string",
      "label": "Configure Short Term or Long Term Guidance",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Blackduck SCA upgrade guidance Values.Default is \"SHORT_TERM, LONG_TERM\"",
      "visibleRule": "blackduckScaFixPrEnabled = true",
      "groupName": "blackduckScaFixPR"
    },
    {
      "name": "blackduckScaFixPrFilterSeverities",
      "type": "string",
      "label": "List of SEVERITIES to be filtered",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Filter the vulnerabilities by given severities, Fix PR(s) will be created only for issues where the issue severity matches one of the values specified using this option Values. Default is \"CRITICAL,  HIGH\".",
      "visibleRule": "blackduckScaFixPrEnabled = true",
      "groupName": "blackduckScaFixPR"
    },
    {
      "name": "blackduckScaReportsSarifCreate",
      "type": "boolean",
      "label": "Generate SARIF Report",
      "defaultValue": false,
      "required": false,
      "helpMarkDown": "SARIF report will be uploaded as a Artifact.",
      "groupName": "blackduckScaSarifReport"
    },
    {
      "name": "blackduckScaReportsSarifGroupSCAIssues",
      "type": "boolean",
      "label": "Group SCA Issues by Component",
      "defaultValue": true,
      "required": false,
      "helpMarkDown": "Uncheck this to disable grouping by component and list SCA issues by vulnerability.",
      "visibleRule": "blackduckScaReportsSarifCreate = true",
      "groupName": "blackduckScaSarifReport"
    },
    {
      "name": "blackduckScaReportsSarifFilePath",
      "type": "string",
      "label": "SARIF Report File Path",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "File path (including file name) where SARIF report is created.",
      "visibleRule": "blackduckScaReportsSarifCreate = true",
      "groupName": "blackduckScaSarifReport"
    },
    {
      "name": "blackduckScaReportsSarifSeverities",
      "type": "string",
      "label": "SARIF Report Severities",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Comma separated list of issue severities to include in SARIF report. Supported values: CRITICAL,HIGH,MEDIUM,LOW",
      "visibleRule": "blackduckScaReportsSarifCreate = true",
      "groupName": "blackduckScaSarifReport"
    },
    {
      "name": "blackduckScaScanFull",
      "type": "radio",
      "label": "Scan Mode",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Specify the scan mode to use. Recommended auto mode uses Rapid scan for PR scans and Intelligent scans for non-PR scans. All post scan features such as PR comments are only supported in this mode. Use Full or Rapid scan modes only if you want to set the scan type for both PR and non-PR contexts but note that post scan features such as PR comments are not supported.",
      "options": {
        "": "Auto (Recommended)",
        "true": "Intelligent",
        "false": "Rapid"
      },
      "groupName": "blackduckScaScanOptions"
    },
    {
      "name": "blackduckScaScanFailureSeverities",
      "type": "string",
      "label": "Scan Failure Severities",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Specify scan failure severities of Black Duck SCA. Supported values: ALL, NONE, BLOCKER, CRITICAL, MAJOR, MINOR, OK, TRIVIAL, UNSPECIFIED",
      "groupName": "blackduckScaScanOptions"
    },
    {
      "name": "detectSearchDepth",
      "type": "string",
      "label": "Search Depth",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Number indicating the search depth in the source directory",
      "groupName": "blackduckScaToolOptions"
    },
    {
      "name": "detectConfigPath",
      "type": "string",
      "label": "Config File Path",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Detect config file path (.properties/.yml).",
      "groupName": "blackduckScaToolOptions"
    },
    {
      "name": "detectArgs",
      "type": "string",
      "label": "Additional Arguments",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Additional Detect Arguments separated by space.",
      "groupName": "blackduckScaToolOptions"
    },
    {
      "name": "detectInstallDirectory",
      "type": "string",
      "label": "Detect Installation Directory",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Provide the Detect installation directory on the agent where it will be installed during the build",
      "groupName": "blackduckScaToolOptions"
    },
    {
      "name": "detectSearchDepthForPolaris",
      "type": "string",
      "label": "Search Depth",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Number indicating the search depth in the source directory.",
      "groupName": "blackduckScaToolOptionsForPolaris"
    },
    {
      "name": "DetectConfigPathForPolaris",
      "type": "string",
      "label": "Config File Path",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Detect config file path (.properties/.yml).",
      "groupName": "blackduckScaToolOptionsForPolaris"
    },
    {
      "name": "DetectArgsForPolaris",
      "type": "string",
      "label": "Additional Arguments",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Additional Detect Arguments separated by space.",
      "groupName": "blackduckScaToolOptionsForPolaris"
    },
    {
      "name": "DetectSearchDepthForSrm",
      "type": "string",
      "label": "Search Depth",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Number indicating the search depth in the source directory.",
      "groupName": "blackduckScaToolOptionsForSrm"
    },
    {
      "name": "DetectConfigPathForSrm",
      "type": "string",
      "label": "Config File Path",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Detect config file path (.properties/.yml).",
      "groupName": "blackduckScaToolOptionsForSrm"
    },
    {
      "name": "DetectArgsForSrm",
      "type": "string",
      "label": "Additional Arguments",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Additional Detect Arguments separated by space.",
      "groupName": "blackduckScaToolOptionsForSrm"
    },
    {
      "name": "detectExecutionPath",
      "type": "string",
      "label": "Detect Execution Path",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Provide the Detect execution path on the agent where it will be installed during the build.",
      "groupName": "blackduckScaToolOptionsForSrm"
    },
    {
      "name": "srmUrl",
      "type": "string",
      "label": "URL",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "URL for SRM Server.",
      "visibleRule": "scanType = srm",
      "groupName": "scanConfiguration"
    },
    {
      "name": "srmApikey",
      "type": "string",
      "label": "API Key",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "API Key for SRM server with proper authorization",
      "visibleRule": "scanType = srm",
      "groupName": "scanConfiguration"
    },
    {
      "name": "srmAssessmentTypes",
      "type": "string",
      "label": "Assessment Types",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "SRM assessment types. Supported values: SCA or SAST or both SCA, SAST",
      "visibleRule": "scanType = srm",
      "groupName": "scanConfiguration"
    },
    {
      "name": "srmProjectDirectory",
      "type": "string",
      "label": "Project Directory",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "The project source directory. Defaults to repository root directory. Set this to specify a custom folder that is other than repository root",
      "visibleRule": "scanType = srm",
      "groupName": "scanConfiguration"
    },
    {
      "name": "srmMarkBuildStatus",
      "type": "pickList",
      "label": "Mark Build Status",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Specify the build status to use if policy violating issues are found. Default value: Failed. Supported values are: Failed, SucceededWithIssues and Succeeded.",
      "options": {
        "": "Select",
        "Failed": "Failed",
        "SucceededWithIssues": "SucceededWithIssues",
        "Succeeded": "Succeeded"
      },
      "visibleRule": "scanType = srm",
      "groupName": "scanConfiguration"
    },
    {
      "name": "srmIncludeDiagnostics",
      "type": "boolean",
      "label": "Include Diagnostics",
      "defaultValue": false,
      "required": false,
      "helpMarkDown": "Bridge CLI diagnostics will be uploaded in Artifact. Supported values: true or false",
      "visibleRule": "scanType = srm",
      "groupName": "scanConfiguration"
    },
    {
      "name": "srmWaitForScan",
      "type": "boolean",
      "label": "Wait For Scan Completion",
      "defaultValue": true,
      "required": false,
      "helpMarkDown": "Specifies if the workflow should wait for the analysis to complete. Default value: true. If set to false, post merge workflows will not be applicable.",
      "visibleRule": "scanType = srm",
      "groupName": "scanConfiguration"
    },
    {
      "name": "srmProjectName",
      "type": "string",
      "label": "SRM Project Name",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Project name in SRM server. If not provided, Azure repository name will be set as default value.",
      "groupName": "srmScanOptions"
    },
    {
      "name": "srmProjectId",
      "type": "string",
      "label": "SRM Project ID",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Project ID in SRM server.",
      "groupName": "srmScanOptions"
    },
    {
      "name": "srmBranchName",
      "type": "string",
      "label": "SRM Branch",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Branch name in SRM server.",
      "groupName": "srmScanOptions"
    },
    {
      "name": "srmBranchParent",
      "type": "string",
      "label": "SRM Parent Branch",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Parent Branch name in SRM server.",
      "groupName": "srmScanOptions"
    }
  ],
  "execution": {
    "Node10": {
      "target": "dist/index.js"
    },
    "Node16": {
      "target": "dist/index.js"
    },
    "Node20_1": {
      "target": "dist/index.js"
    }
  }
}
